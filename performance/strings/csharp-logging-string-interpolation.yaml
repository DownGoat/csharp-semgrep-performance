rules:
- id: csharp-logging-string-interpolation
  patterns:
  - pattern-either:
    - pattern: $LOG.$METHOD($"...")
    - pattern: $LOG.$METHOD("..." + $VAR)
  - metavariable-regex:
      metavariable: $LOG
      regex: .*(log|LOG|Log)
  - metavariable-regex:
      metavariable: $METHOD
      regex: (Debug|Error|FatalInformation|Verbose|Warning|LogCritical|LogDebug|LogError|LogInformation|LogTrace|LogWarning|Info|Trace|Warn)
  message: >-
    String interpolation in log message creates extra allocations.
  languages: [csharp]
  severity: WARNING
  metadata:
    category: performance
    subcategory:
    - easyfix
    - strings
    likelihood: LOW
    impact: LOW